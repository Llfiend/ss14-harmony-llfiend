- type: entity
  parent: BaseMobDragon
  id: MobPoisonDragon
  suffix: "Harmony"
  name: poison dragon
  components:
  - type: Dragon
    spawnRiftAction: ActionSpawnRiftPoisonDragon
    riftPrototype: CarpPoisonRift
  - type: RandomSprite
    available:
    - enum.DamageStateVisualLayers.Base:
        alive: PoisonDragonPalette
  - type: Sprite
    sprite: _Harmony/Mobs/Aliens/Carps/dragonpoison.rsi
    noRot: true
    layers:
    - map: [ "enum.DamageStateVisualLayers.Base" ]
      state: alive
    - map: [ "enum.DamageStateVisualLayers.BaseUnshaded" ]
      state: alive-unshaded
      shader: unshaded
  - type: Damageable
    damageContainer: Biological
    damageModifierSet: PoisonDragon
  - type: Flammable
    damage:
      types:
        Heat: 1.0
  - type: StatusEffects
  - type: SolutionContainerManager
    solutions:
      toxin:
        reagents:
        - ReagentId: Dracotoxin
          Quantity: 99999
  - type: MeleeChemicalInjector
    transferAmount: 0.75
    solution: toxin
    pierceArmor: true
  - type: RandomMetadata
    nameSegments:
    - NamesPoisonDragon
    - NamesPoisonDragonTitle
  - type: GhostRole
    mindRoles:
    - MindRoleDragon
  - type: ActionGun
    action: ActionDragonsPoisonBreath
    gunProto: DragonsPoisonBreathGun
  - type: GuideHelp
    guides:
    - MinorAntagonists

- type: entity
  categories: [ HideSpawnMenu ]
  id: DragonsPoisonBreathGun
  name: dragon's lung
  description: For dragon's breathing.
  components:
  - type: RechargeBasicEntityAmmo
    rechargeCooldown: 5
    rechargeSound:
      path: /Audio/Animals/space_dragon_roar.ogg
  - type: BasicEntityAmmoProvider
    proto: ProjectileDragonsPoisonBreath
    capacity: 1
    count: 1
  - type: Gun
    soundGunshot:
      path: /Audio/Animals/space_dragon_roar.ogg
    soundEmpty: null
    projectileSpeed: 9

- type: entity
  parent: BaseAction
  id: ActionSpawnRiftPoisonDragon
  name: Summon Poison Carp Rift
  description: Summons a poison carp rift that will periodically spawn poison carp.
  components:
  - type: Action
    icon:
      sprite: Interface/Actions/carp_rift.rsi
      state: icon
    useDelay: 1
    priority: 3
  - type: InstantAction
    event: !type:DragonSpawnRiftActionEvent

- type: entity
  parent: BaseAction
  id: ActionDragonsPoisonBreath
  name: "[color=purple]Dragon's Breath[/color]"
  description: Spew out poison at anyone foolish enough to attack you!
  components:
  - type: Action
    # TODO: actual sprite and iconOn
    icon: { sprite : _Harmony/Objects/Weapons/Guns/Projectiles/magic.rsi, state: fireballpoison }
    itemIconStyle: BigAction
    priority: 2
  - type: TargetAction
    checkCanAccess: false
    range: 0
  - type: WorldTargetAction
    event: !type:ActionGunShootEvent
